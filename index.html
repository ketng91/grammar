<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Học Grammar - Lớp Anh thầy Kết</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body {
  font-family: Arial, sans-serif;
  background-color: #fff8f0;
  margin: 0;
  padding: 0;
  text-align: center;
}

body {
  padding-bottom: 110px; /* hoặc tuỳ chỉnh theo ý muốn */
}


#vnSentence {
  color: #4b6b3b;        /* xanh lá vintage */
  font-weight: bold;      /* in đậm */
  font-size: 22px;        /* cỡ chữ lớn */
  margin-bottom: 20px;    /* thêm khoảng cách dưới */
}

#fullAnswer {
  width: 93%;               /* bằng width của #vnSentence */
  font-size: 22px;           /* cỡ chữ vừa nhìn */
  font-family: 'Arial', sans-serif; /* kiểu chữ bạn muốn */
  height: 80px;              /* giữ cao phù hợp */
  text-align: center;  
  margin-top: 10px;          /* khoảng cách trên */
  margin-bottom: 20px;       /* khoảng cách dưới */
  padding: 8px;
  box-sizing: border-box;    /* bao gồm padding trong width */
  border-radius: 10px;
  border: 3px solid #ccc;
}


#submitBtn,
#changeBtn {
  font-size: 18px;          /* chữ to hơn */
  padding: 12px 25px;       /* padding ngang đủ cho chữ */
  min-width: 160px;         /* đảm bảo nút đủ rộng */
  white-space: nowrap;      /* không xuống dòng */
  margin: 10px 5px;
  cursor: pointer;
  border-radius: 8px;
  border: none;
  background-color: #a0e7e5;
  transition: background-color 0.25s ease, transform 0.2s ease;
}

#submitBtn:hover,
#changeBtn:hover,
#submitBtn:active,
#changeBtn:active {
  background-color: #ffb3ba;
  transform: translateY(-2px);
}


/* ===== HEADER ===== */
header {
  background-color: #ffd6ba;
  padding: 15px 20px;
  font-weight: bold;
  color: #7a4e3e;
  display: flex;
  flex-wrap: wrap;       
  align-items: center;
  justify-content: space-between;  /* Left luôn bên trái, center căn giữa */
  gap: 15px;
}

/* Left: icon + home text */
.header-left {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 0 0 auto;          /* không bị co lại */
}

.header-left a {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 24px;
  color: #7a4e3e;
  text-decoration: none;
}

.header-left a i {
  font-size: 28px;
}
/* Center title */
header {
  position: relative;
}

.header-center {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  font-size: 32px;
  margin: 0;
  white-space: nowrap;
}

/* TOP SELECT */
.top-select { display: flex; justify-content: center; margin: 20px; }
select {
  padding: 8px 14px;
  font-size: 18px;
  border-radius: 8px;
  border: 2px solid #a0e7e5;
  background-color: #e3fdfd;
}

/* Grammar box */
.grammar-box {
  width: 85%;
  margin: 20px auto;
  background-color: #d0f0fd;  /* xanh nhạt */
  border-radius: 10px;
  padding: 20px;
  text-align: left;
  font-size: 20px;
  line-height: 1.6;
}

/* ===== Khung xem Google Drive ===== */
.drive-box {
  width: 90%;
  margin: 20px auto;
  background-color: #d0e7ff;  /* màu xanh nhạt */
  border-radius: 12px;
  padding: 10px;
}
.drive-box iframe {
  width: 100%;
  height: 500px;
  border-radius: 10px;
}

/* Bài tập điền từ */
.section-title { font-size: 26px; font-weight: bold; margin: 20px 0 10px 0; }
.exercise, .translation-exercise { width: 80%; margin: 0 auto 30px auto; font-size: 22px; text-align: left; }
.exercise input, .translation-exercise input {
  width: 220px;
  font-size: 20px;
  padding: 5px;
  margin-left: 10px;
  border-radius: 6px;
}
.exercise button, .translation-exercise button {
  margin-left: 10px;
  padding: 6px 12px;
  font-size: 18px;
  background-color: #a0e7e5;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}
.exercise button:hover, .translation-exercise button:hover { background-color: #ffb3ba; }
.result { font-weight: bold; color: #C5705D; font-size: 20px; margin-left: 10px; }

/* ===== VẬN DỤNG VIẾT CÂU ===== */
.sentence-box {
  background-color: #ffe0f0; 
  border: 2px solid #ffb3d9;
  border-radius: 12px;
  padding: 15px 20px;
  font-size: 28px;           /* cỡ chữ lớn */
  font-weight: bold;          /* in đậm */
  color: #4b6b3b;            /* xanh lá vintage */
  text-align: center;
  margin: 20px auto;
  width: 90%;
  min-height: 120px;          /* cố định chiều cao tối thiểu */
  display: flex;
  align-items: center;        /* căn giữa theo chiều dọc */
  justify-content: center;    /* căn giữa ngang */
  box-sizing: border-box;
  word-wrap: break-word;      /* xuống dòng nếu quá dài */
}
.input-row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
  justify-content: flex-start; /* vẫn căn lề trái */
  flex-wrap: wrap;
  margin-left: 140px; /* dịch vào từ lề trái */
}

.input-row input {
  padding: 6px;
  width: 300px; /* cố định chiều rộng */
  font-size: 22px;
  border: 1px solid #ccc;
  border-radius: 4px;
  flex-shrink: 0; /* không bị co lại */
}

.input-row button {
  width: 100px; /* cố định button */
  padding: 6px 10px;
  font-size: 18px;
  flex-shrink: 0;
}

.input-row .result {
  min-width: 120px; /* khung hiển thị kết quả cố định */
  display: inline-block;
}
.arrow-icon { font-size: 18px; font-weight: bold; }
.correct { color: green; font-weight: bold; font-size: 18px; }
.wrong { color: red; font-weight: bold; font-size: 18px; }

.full-answer-box { width: 95%; max-width: 100%; height: 100px; padding: 8px; font-size: 25px; color: blue; border-radius: 10px; border: 5px solid #ccc; box-sizing: border-box; }
.full-submit { padding: 10px 12px; margin-top: 10px;}

button { padding: 8px 0; margin-right: 10px; cursor: pointer; border-radius: 5px; border: none; background-color: #a0e7e5; font-size: 16px; width: 140px; transition: background-color 0.25s ease, transform 0.2s ease; }
button:hover, button:active { background-color: #ffb3ba; transform: translateY(-2px); }

.signature {
  font-size: 18px;
  font-style: italic;
  font-weight: bold;
  color: #004aad;
  text-align: right;        /* vẫn phải căn phải */
  margin-top: -25px;
  margin-right: 50px;       /* dịch vào trái 50px */
}

.confetti {
  position: fixed;
  top: 50%;
  left: 50%;
  width: 8px;
  height: 8px;
  background: red;
  border-radius: 50%;
  pointer-events: none;
  opacity: 0.9;
  animation: pop 1s ease-out forwards;
  z-index: 9999;
}

@keyframes pop {
  0% {
    transform: translate(0,0) scale(1);
    opacity: 1;
  }
  50% {
    transform: translate(calc(var(--x)*0.5), calc(var(--y)*0.5)) scale(1.2);
    opacity: 1;
  }
  100% {
    transform: translate(var(--x), var(--y)) scale(0.5);
    opacity: 0;
  }
}

@media(max-width:480px){
   .header-center {
    flex-basis: 100%;
    order: 2;
    text-align: center;
    position: static;
    transform: none;
    margin-top: 8px;
  }

  .header-left {
    order: 1;
  }
}

  header {
    padding: 10px 15px;
  }
  .header-left a {
    font-size: 18px;
  }
  .header-left a i {
    font-size: 20px;
  }
  .header-center {
    font-size: 22px;
  }
}



  body{margin:10px;padding:10px;}
  .sentence-box{font-size:18px;width:90%;}
  .full-answer-box{width:100%;font-size:16px;height:80px;}
  button{width:140px;font-size:14px;margin-bottom:5px;}
}
</style>
</head>

<body>

<header>
  <div class="header-left">
    <a href="https://ketng91.github.io/lopanhthayket/">
      <i class="fa-solid fa-house"></i>
    </a>
    <span class="header-text">Lớp Anh thầy Kết</span>
  </div>
  <div class="header-center">Khoá Grammar</div>
</header>

<!-- Chọn topic -->
<div class="top-select">
  <select id="topicSelect"></select>
</div>

<!-- Lý thuyết -->
<div class="grammar-box" id="grammarContainer"></div>

<!-- Khung Google Drive -->
<div class="drive-box">
  <iframe id="driveFrame" src="" frameborder="0" allowfullscreen></iframe>
</div>

<!-- Bài tập điền từ -->
<div class="section-title">Bài tập điền từ</div>
<div class="exercise" id="exercise"></div>

<!-- Bài tập dịch câu -->
<div class="section-title">Bài tập dịch câu</div>
<div class="sentence-box" id="vnSentence"></div>
<div id="inputs"></div>
<textarea id="fullAnswer" class="full-answer-box" placeholder="Nhập câu dịch tiếng Anh..."></textarea><br>
<button id="submitBtn" class="full-submit">Submit</button>
<button id="changeBtn">Next sentence</button>
<div id="fullResult"></div>

<div class="signature">Lớp Anh thầy Kết</div>

<script>




/* ===== DATA ===== */
const grammarData = {
  "MĐQH": "MĐQH-MĐQH rút gọn",
};




const driveLinks = {
  "MĐQH": "https://docs.google.com/document/d/1c3aJf7_Gioxha_NpwOJW5d8Crfo07V5y/preview",
};






const exercises = {
  "MĐQH":[
  {q: "The scientist _____ won the Nobel Prize is giving a lecture today.", a: "who"},
  {q: "The house _____ roof was damaged in the storm has been repaired.", a: "whose"},
  {q: "The candidates _____ we interviewed yesterday were all very well-qualified.", a: ["who", "whom"]},
  {q: "Sustainable energy, _____ is becoming more affordable, helps reduce carbon emissions.", a: "which"},
  {q: "I am looking for a colleague _____ specializes in environmental law.", a: "who"},
  {q: "The city _____ I grew up in has changed significantly over the last decade.", a: "which"},
  {q: "Students _____ assignments are submitted late will lose 10% of their grade.", a: "whose"},
  {q: "This is the most innovative solution _____ has been proposed so far.", a: "that"},
  {q: "The person to _____ you should send the application is the HR Manager.", a: "whom"},
  {q: "Electric cars, _____ produce zero tailpipe emissions, are key to cleaner air.", a: "which"}
  ],






};

const dataByTopic = {
  "MĐQH":[
{
    vn: "Học sinh du học thường phát triển tính tự lập và khả năng thích nghi cao hơn.",
    parts: [
      {en: "study abroad", vn: "du học", color: "green"},
      {en: "independence", vn: "tính tự lập", color: "orange"},
      {en: "adaptability", vn: "khả năng thích nghi", color: "purple"}
    ],
    full: "Students studying abroad often develop greater independence and adaptability."
  },
  {
    vn: "Các chính sách giáo dục do chính phủ thực hiện nhằm đảm bảo cơ hội bình đẳng cho mọi người.",
    parts: [
      {en: "Education policies", vn: "chính sách giáo dục", color: "green"},
      {en: "implemented by", vn: "thực hiện bởi", color: "blue"},
      {en: "ensure", vn: "đảm bảo", color: "orange"},
      {en: "equal opportunities", vn: "cơ hội bình đẳng", color: "purple"}
    ],
    full: "Education policies implemented by the government aim to ensure equal opportunities for all."
  },
  {
    vn: "Công nghệ, vốn đang phát triển với tốc độ nhanh, đã thay đổi cách chúng ta giao tiếp.",
    parts: [
      {en: "evolving", vn: "đang phát triển", color: "green"},
      {en: "rapid pace", vn: "tốc độ nhanh", color: "blue"},
      {en: "transformed", vn: "thay đổi hoàn toàn", color: "orange"},
      {en: "communicate", vn: "giao tiếp", color: "purple"}
    ],
    full: "Technology, evolving at a rapid pace, has transformed the way we communicate."
  },
  {
    vn: "Các công ty cung cấp giờ làm việc linh hoạt có thể cải thiện sự hài lòng của nhân viên.",
    parts: [
      {en: "flexible working hours", vn: "giờ làm việc linh hoạt", color: "green"},
      {en: "improve", vn: "cải thiện", color: "blue"},
      {en: "employee satisfaction", vn: "sự hài lòng của nhân viên", color: "orange"}
    ],
    full: "Companies providing flexible working hours can improve employee satisfaction."
  },
  {
    vn: "Học sinh, đang đối mặt với áp lực ngày càng tăng từ các kỳ thi, cần được hỗ trợ sức khỏe tâm thần tốt hơn.",
    parts: [
      {en: "facing", vn: "đối mặt với", color: "green"},
      {en: "increasing pressure", vn: "áp lực ngày càng tăng", color: "blue"},
      {en: "mental health", vn: "sức khỏe tâm thần", color: "orange"},
      {en: "support", vn: "hỗ trợ", color: "purple"}
    ],
    full: "Students, facing increasing pressure from exams, need better mental health support."
  },


  ],





};

let currentTopic = Object.keys(dataByTopic)[0];
let currentIndex = 0;

/* ===== INIT SELECT ===== */
const topicSelect = document.getElementById("topicSelect");
Object.keys(dataByTopic).sort().forEach(topic=>{
  const opt=document.createElement("option"); opt.value=topic; opt.textContent=topic;
  topicSelect.appendChild(opt);
});
topicSelect.value = currentTopic;

/* ===== LOAD CONTENT ===== */
function loadContent(){
  // Grammar
  document.getElementById("grammarContainer").innerText = grammarData[currentTopic];
  document.getElementById("driveFrame").src = driveLinks[currentTopic] || "";

  // Bài tập điền từ
  const box=document.getElementById("exercise");
  box.innerHTML="";
  exercises[currentTopic].forEach((item,i)=>{
    box.innerHTML+=`<div style="margin:10px 0;">${i+1}. ${item.q} <input id="ex${i}"><button onclick="checkEx(${i})">Check</button><span id="resEx${i}" class="result"></span></div>`;
  });

  // Bài tập dịch câu
  loadWriting();
}

/* ===== CHECK EXERCISE ===== */
function checkEx(i){
  const user = document.getElementById("ex"+i).value.trim().toLowerCase();
  const ans = exercises[currentTopic][i].a; // có thể là string hoặc array
  const box = document.getElementById("resEx"+i);

  let correct = false;
  if(Array.isArray(ans)){
    correct = ans.some(a => a.toLowerCase() === user);
  } else {
    correct = user === ans.toLowerCase();
  }

  if(correct){
    box.innerHTML = '<span style="color:green;font-weight:bold;">✔ Correct</span>';
    firework(); // gọi pháo hoa khi đúng
  } else {
    box.innerHTML = '<span style="color:red;font-weight:bold;">✘ ' + (Array.isArray(ans) ? ans.join(" / ") : ans) + '</span>';
  }
}

/* ===== LOAD VIẾT CÂU ===== */
function loadWriting(){
  const item = dataByTopic[currentTopic][currentIndex];
  document.getElementById("vnSentence").innerHTML = item.vn;

  const container = document.getElementById("inputs"); container.innerHTML="";
  item.parts.forEach((p,idx)=>{
    const first=p.en[0], wc=p.en.split(" ").length;
    const hint = `${p.vn} (${first}... ; ${wc} word${wc>1?'s':''})`;
    const row = document.createElement("div");
    row.className="input-row";
    row.innerHTML=`<span class="arrow-icon" style="color:${p.color};">➤</span><input id="box${idx}" placeholder="${hint}"><button onclick="checkWord(${idx})">Check</button><span id="resWord${idx}" class="result"></span>`;
    container.appendChild(row);
    row.querySelector("input").addEventListener("keydown",(e)=>{if(e.key==="Enter"){e.preventDefault(); checkWord(idx);}});
  });

  document.getElementById("fullAnswer").value=""; 
  document.getElementById("fullResult").innerHTML="";
}

/* ===== CHECK WORD ===== */
window.checkWord = function(i){
  const item = dataByTopic[currentTopic][currentIndex];
  const user=document.getElementById("box"+i).value.trim();
  const key=item.parts[i].en; 
  const res=document.getElementById("resWord"+i);

  if(user.toLowerCase()===key.toLowerCase()){
    res.innerHTML = '<span style="color:green;font-weight:bold;">✔ Correct</span>';
    firework(); // gọi pháo hoa khi đúng
  } else {
    res.innerHTML = '<span style="color:red;font-weight:bold;">✘ ' + key + '</span>';
  }
}

/* ===== CHECK FULL SENTENCE ===== */
document.getElementById("submitBtn").onclick=()=>{
  const item = dataByTopic[currentTopic][currentIndex];
  const user=document.getElementById("fullAnswer").value.trim();
  const res=document.getElementById("fullResult");
  if(user.toLowerCase()===item.full.toLowerCase()){
    res.innerHTML='<span class="correct">✔ Correct</span>'; 
    firework(); // gọi pháo hoa
  }
  else{
    res.innerHTML=`<span class="wrong">✘ ${item.full}</span>`;
  }
}

/* ===== NEXT SENTENCE ===== */
document.getElementById("changeBtn").onclick = () => {
  const topicData = dataByTopic[currentTopic];
  
  // Chọn random index khác với currentIndex để tránh lặp ngay lập tức
  let newIndex;
  do {
    newIndex = Math.floor(Math.random() * topicData.length);
  } while (newIndex === currentIndex && topicData.length > 1);

  currentIndex = newIndex;
  loadWriting();
}


/* ===== LOAD INIT ===== */
loadContent();

// ===== ENTER SUBMIT CHO TẤT CẢ INPUT =====
document.addEventListener("keydown", function(e){
  if(e.key === "Enter"){
    const el = document.activeElement;
    
    // Bài tập điền từ
    if(el && el.id.startsWith("ex")){
      const i = parseInt(el.id.replace("ex",""));
      checkEx(i);
      e.preventDefault();
    }

    // Bài tập viết câu (từng từ)
    else if(el && el.id.startsWith("box")){
      const i = parseInt(el.id.replace("box",""));
      checkWord(i);
      e.preventDefault();
    }

    // Bài tập full sentence
    else if(el && el.id === "fullAnswer"){
      document.getElementById("submitBtn").click();
      e.preventDefault();
    }
  }
});


/* ===== SELECT TOPIC ===== */
topicSelect.addEventListener("change",(e)=>{
  currentTopic = e.target.value; currentIndex=0; loadContent();
});

/* ===== ENTER SUBMIT ===== */
document.getElementById("fullAnswer").addEventListener("keydown",(e)=>{
  if(e.key==="Enter"){e.preventDefault(); document.getElementById("submitBtn").click();}
});

/* ===== PHÁO HOA ===== */
function firework() {
  const count = 50; // số lượng pháo hoa
  for (let i = 0; i < count; i++) {
    const conf = document.createElement("div");
    conf.className = "confetti";
    const angle = Math.random() * 2 * Math.PI; // góc bắn
    const radius = 150 + Math.random() * 150;   // bán kính bắn ra
    conf.style.setProperty("--x", Math.cos(angle) * radius + "px");
    conf.style.setProperty("--y", Math.sin(angle) * radius + "px");
    conf.style.backgroundColor = `hsl(${Math.random() * 360}, 90%, 60%)`;
    conf.style.width = conf.style.height = (6 + Math.random() * 6) + "px";
    document.body.appendChild(conf);
    setTimeout(() => conf.remove(), 1200);
  }
}

/* ===== LOAD INIT ===== */
loadContent();
</script>
</body>
</html>
